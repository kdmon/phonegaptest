<html>

  <head>
    <script type="text/javascript" src="phonegap.js"></script>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script>
    
      var dready = false;
      
      document.addEventListener("deviceready", init, false);

      function init() {
        
        msg ("Dev init", "Device ready");
        
        if (dready) return;
        dready = true;
        
        // window.plugin.backgroundMode.enable();
        
        setInterval(function() {
          
        msg ("getting title...", "from wp");
        
          $.get("http://en.wikipedia.org/w/api.php?action=query&list=pageswithprop&format=json&pwppropname=title&pwpprop=title&pwplimit=1&generator=random&grnnamespace=0&grnlimit=1", function (data){
              alert (data);
              var obj = JSON.parse(data);
              var title = '';
              $.each(obj.query.pages, function (k,v) {title = obj.query.pages[k].title});
              msg ("Random Wikipedia article", title);
          });
        
          window.plugin.notification.local.onclick = function(id, state, json) {
            alert(id + state + json);
          };
      
        },  5000);
      
      }
      
      var c = 100;

      function msg(t, m, s) {
        c++;
        window.plugin.notification.local.add({
            id: c,
            title: t || 'No title',
            message: m || 'No message',
            sound: s || 'TYPE_NOTIFICATION'
          });
      }
    </script>
  </head>

  <body>
    <h1>Phonegap local notification test 2</h1>
    <button style="font-size: 2em; padding: 10px; background: #cfc;" onclick="javascript: msg('Not', Notification msg', 'TYPE_NOTIFICATION');">Notification!</button>
    <button style="font-size: 2em; padding: 10px; background: #cfc;" onclick="javascript: msg('Ala', Alarm msg', 'TYPE_ALARM');">Alarm!</button>
    <button style="font-size: 2em; padding: 10px; background: #cfc;" onclick="javascript: msg('Rng', Ringtone msg', 'TYPE_RINGTONE');">Ringtone!</button>
    <button style="font-size: 2em; padding: 10px; background: #cfc;" onclick="javascript: msg('mp3a', mp3 msg', '/gaudio.mp3');">mp3-a!</button>
    <button style="font-size: 2em; padding: 10px; background: #cfc;" onclick="javascript: msg('mp3b', 'mp3 msg', '/www/gaudio.mp3');">mp3-b!</button>
  </body>

</html>